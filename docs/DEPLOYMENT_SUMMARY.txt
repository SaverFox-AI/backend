=== SAVERFOX RENDER DEPLOYMENT - QUICK START ===

ğŸ“¦ FILES CREATED:
âœ… requirements.txt - Python dependencies
âœ… Dockerfile.render - Docker configs (both services)
âœ… render-build.sh - Build scripts
âœ… start.sh - Startup script with migrations
âœ… health.controller.ts - Health check endpoint
âœ… RENDER_DEPLOY.txt - Detailed deployment guide
âœ… ENV_VARIABLES_RENDER.txt - Environment variables reference
âœ… deploy-to-render.sh - Deployment helper script
âœ… test-deployment.sh - Post-deployment testing

ğŸ”§ FIXES APPLIED:
âœ… Fixed API endpoint paths (/v1 â†’ /api)
âœ… Added health endpoints for both services
âœ… Fixed migration script to use compiled JS
âœ… Added startup script with migration runner
âœ… Created requirements.txt for Python service

ğŸ“‹ DEPLOYMENT CHECKLIST:

â–¡ 1. Prepare API Keys
   - OpenAI API key
   - Opik API key
   - Generate JWT secret (32+ chars)

â–¡ 2. Push to GitHub
   git add .
   git commit -m "Add Render deployment config"
   git push origin main

â–¡ 3. Create PostgreSQL Database on Render
   - Name: saverfox-db
   - Region: Singapore
   - Save connection details

â–¡ 4. Deploy AI Python Service
   - Root: backend/apps/ai-python
   - Build: pip install -r requirements.txt
   - Start: uvicorn src.main:app --host 0.0.0.0 --port $PORT
   - Add environment variables (see ENV_VARIABLES_RENDER.txt)
   - Save service URL

â–¡ 5. Deploy API TypeScript Service
   - Root: backend/apps/api-ts
   - Build: npm install && npm run build
   - Start: sh start.sh
   - Add environment variables (see ENV_VARIABLES_RENDER.txt)
   - Use AI service URL from step 4

â–¡ 6. Test Deployment
   ./test-deployment.sh <AI_URL> <API_URL>

ğŸ”— IMPORTANT URLS:

After deployment, you'll have:
- AI Service: https://saverfox-ai-python.onrender.com
- API Service: https://saverfox-api-ts.onrender.com
- API Docs: https://saverfox-api-ts.onrender.com/api/docs

ğŸ“ ENDPOINTS:

AI Service:
- GET  /health
- POST /api/adventure/generate
- POST /api/adventure/evaluate

API Service:
- GET  /api/health
- POST /api/auth/register
- POST /api/auth/login
- POST /api/adventure/generate
- POST /api/adventure/submit-choice
- GET  /api/docs (Swagger UI)

âš ï¸ COMMON ISSUES:

1. "Service Unavailable" on first request
   â†’ Free tier services sleep after 15min
   â†’ Wait 30-60s for cold start

2. "Database connection failed"
   â†’ Use INTERNAL database URL
   â†’ Check credentials in env vars

3. "AI Service timeout"
   â†’ Check AI service is running
   â†’ Verify AI_SERVICE_URL is correct
   â†’ Check OPENAI_API_KEY is valid

4. "Migration failed"
   â†’ Run manually: npm run migration:run
   â†’ Check database connection
   â†’ Verify DB credentials

5. Build fails
   â†’ Check logs in Render dashboard
   â†’ Verify all dependencies exist
   â†’ Check Node/Python versions

ğŸ“š DETAILED GUIDES:

- Full deployment: cat RENDER_DEPLOY.txt
- Environment vars: cat ENV_VARIABLES_RENDER.txt
- Run helper: ./deploy-to-render.sh
- Test services: ./test-deployment.sh <AI_URL> <API_URL>

ğŸ¯ NEXT STEPS AFTER DEPLOYMENT:

1. Test health endpoints
2. Register a test user
3. Create a profile
4. Generate an adventure
5. Submit a choice
6. Check Opik dashboard for traces

ğŸ’¡ TIPS:

- Keep service URLs handy
- Monitor logs during first deployment
- Test each service independently first
- Use Postman collection for API testing
- Check Opik dashboard for AI traces

ğŸš€ READY TO DEPLOY!

Run: ./deploy-to-render.sh
Then follow: RENDER_DEPLOY.txt
